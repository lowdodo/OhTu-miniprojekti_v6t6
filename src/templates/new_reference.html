{% extends "layout.html" %}

{% block title %}
New Reference
{% endblock %}

{% block body %}
<script>
  function add_author() {
    var authorsContainer = document.getElementById('authorsContainer');
    var Authors = authorsContainer.getElementsByClassName('author-entry').length;
    
    if (Authors >= 21) {
        alert('You can only add max 21 authors');
        return;
    }
    
    const authorEntry = document.createElement('div');
    authorEntry.className = 'author-entry';
    authorEntry.innerHTML = `
        <input placeholder="Author" type="text" name="author" minlength="1" maxlength="200" required>
        <button type="button" class="remove-author" onclick="remove_author(this)">Ã—</button>`;
    authorsContainer.appendChild(authorEntry);
}

function remove_author(button) {
    button.parentElement.remove();
}
function select_reference_type(type) {
  document.getElementById('reference_type').value = type;
}
</script>
<div class="form-section">
  <h2>Add a new article type reference</h2>
  <br>
  <div class="dropdown">
    <button class="dropbtn">Select reference type</button>
    <div class="dropdown-menu">
      <a href=>Article</a>
      <a href=>Book</a>
    </div>
  </div>
  <br>
  <br>
  <br>
  <div>
    <input name="type" type="hidden" value="{{ reference_type }}">
  </div>
    <form action="/create_reference" method="post" onsubmit="return check(this)" >
      <div class="form-grid">

        <div class="authors-container">
          <div id="authorsContainer">
              <div class="author-entry">
                <input placeholder="Author *" type="text" name="author" minlength="1" maxlength="200" required>
                <button class="add-author-button" type="button" onclick="add_author()">+</button>
              </div>
          </div>
      </div>
        <div>
          <input placeholder="Title *" type="text" name="title" minlength="1" maxlength="200" required>
        </div>
        <div>
          <input placeholder="Year *" type="number" name="year" min="1" max="2100" required>
        </div>
        <div>
          <input placeholder="Journal *" type="text" name="journal" minlength="1" maxlength="200" required><br>
        </div>
        <div>
          <input placeholder="Volume (Optional)" type="number" name="volume" min="1" max="5000">
        </div>
        <div>
          <input placeholder="Number (Optional)" type="number" name="number" min="1" max="5000">
        </div>
        <div>
          <input placeholder="Pages (Optional)" type="text" name="pages" minlength="1" maxlength="200">
        </div>
        <div>
          <input placeholder="Month (Optional)" type="number" name="month" min="1" max="12">
        </div>
        <div>
          <input placeholder="Note (Optional)" type="text" name="note" minlength="1" maxlength="200"><br>
        </div>
        <br>
        <br>
      </div> 
      <button class="button add-reference-button" type="submit">
        Add 
      </button>
    </form>
</div>
{% with messages = get_flashed_messages() %}
  {% if messages %}
    {% for message in messages %}
      <div class="success-message">{{ message }}</div>
    {% endfor %}
  {% endif %}
{% endwith %}

{% endblock %}